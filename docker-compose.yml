services:
  api:
    build: ./backend/
    container_name: MIH-API-Hub
    command: sh -c "sleep 10s; uvicorn backend.main:app --reload --port=80 --host=0.0.0.0"
    ports:
      - 80:80
    volumes:
      - .:/app
    depends_on:
      - mysqldb
    networks:
      default:
        aliases:
          - mih-api-hub
  
  mysqldb:
    #build: ./database/
    image: mysql
    container_name: MIH-Database
    restart: always
    environment:
      MYSQL_DATABASE: 'testdb'
      MYSQL_ROOT_PASSWORD: 'C@rtoon1995'
    ports:
      - '3306:3306'
    volumes:
      - ./database:/var/lib/mysql
        
  phpmyadmin:
    image: phpmyadmin/phpmyadmin
    container_name: MIH-phpmyadmin
    links:
      - mysqldb
    environment:
      PMA_HOST: mysqlDB
      PMA_PORT: 3306
      PMA_ARBITRARY: 1
    restart: always
    ports:
      - 8081:80

  user-interface:
    container_name: MIH-UX
    build:
      context: ./Frontend/patient_manager
    ports:
      - "8080:8080"
    # volumes:
    #   - ./Frontend/patient_manager:/app

  minio:
    container_name: MIH-minio
    image: docker.io/bitnami/minio:2022
    ports:
      - '9000:9000'
      - '9001:9001'
    networks:
      - minionetwork
    volumes:
      - './File_Storage/Mzanzi_Innovation_Hub:/data'
    environment:
      - MINIO_ROOT_USER=yaso
      - MINIO_ROOT_PASSWORD=C@rtoon1995

networks:
  minionetwork:
    driver: bridge

volumes:
  Mzanzi_Innovation_Hub:
    driver: local